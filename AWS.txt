2019.12.05

When we crate VPC
		route table
		Network ACL  
		Security Group will create default
		
		screenshot
		
when we create subnet it will not default assign public ip address

Only one Internet gateway can assign to the per VPC



When we create the subnet it default assign to Main route table(default one automaticlly create with creation of VPC) of the VPC
so better we create public route table for public accessible route


public route table out traffic(0.0.0.0/0) set target to internet gateway 
so that route table associate with any subnet then it has internet access

When create the EC2 if its in public facing subnet then public ip address will automatically assigned
When create the EC2 instance that security group(that created with VPC creation) only visible,

Exam tips
When you create a VPC default Route Table, Network Access Control list(NACL) and a default Security Group 
It won't create any subnets, nor will it create a default internet gateway
US-East-1A in your AWS account can be a completely different availability zone to US-East-1A in another AWS account. The AZ's are randomized
Amazon always reserve 5 IP addresses within your subnets
You can only have 1 Internet Gateway per VPC
Security Groups can't span VPCs




To access the private subnet EC2 have to assign to new security group since with the default security groups dose not allow to ping or SSH to the instance
When allowing access from security group you can set source to only internal ip address within VPC
screenshot
 
to access the private subnte ec2 you have to save privet.pem private key in public subnet EC2 instance then you can ssh to private subnet EC2 from there
but its not secure since you save your private key in publically faced machine. so better way is use bastion hosts


Nat Instanes and Nat gateways

screenshot

Nat instances individual ec2 instance to do the internet access.
Nat Gateway is highly available gateway


Nat Instances
to create nat instance you have to create nat ec2 instance(have to select nat instance when creating its commercial)
to this ec2 instance to be a nat instance has to desaible source and destination check

to go out to the internet then private subnets route table out traffic (0.0.0.0/0) has to set to nat instance





Nat Gateway
to go out to the internet then private subnets route table out traffic (0.0.0.0/0) has to set to nat gateway


Exam tips

Nat Instances Exam  tips

When creating a NAT instance, Desable Source/Destination Check on the instance.
NAT instance must be in a public subnet
There must be a route out of the private subnet to the NAT isntcance, in order for this to work
The amount of traffic that NAT instances can support depends on the instance size. If you bottlenecking,increase the instance size.
YOu can create high availablity using Ausoscaling Groups, muliple subnets in different AZs, and a script to automate failover.
Behind a Security Group

Nat Gateways
 Redundant inside the Availability Zone(not single EC2 instance)
 One Nat gatewaork in one AZ
 Preferred by the enterprise
 Starts at 5Gbps and scalses curreltly to 45Gbps
 No need to patch
 Not associated with security groups
 Automatically assigned a public ip address
 Remember to update your route tables for nat gateway
 
 
If you have resources in multiple Availability Zones and they share one NAT gateway, in the event that the NAT gateway's Availability Zone is down,
resources in the other Availability Zones lose internet access. To create an Availability Zone-independent architecture, create a NAT gateway in each Availabiity Zone
and configure your routing to ensure that resources use the NAT gateway in the same Availability Zone.



ACL(Access Control List)

screenshot


have allow rules and deney rules
When create new ACL its defulty deny everyting (inbound and outbound)
When you create ACL you have to select the VPC then you can associate subnets with that ACL
so VPC can have more than one ACLs

rules execuring order to the rule number
between rule numbers better give 100 spaces so later can add other rules in between. 
Deny rules have to define before allow(for example if you add deny rule after allowing 0.0.0.0/0 then it won't work)
(simply if you allow before deny it won't work)

When you create VPC it will create ACL automatically and subnets you create in that VPC automatically assigned to that ACL
if you need to change the ACL you can create a ACL by your own and subnet can assign to that ACL
Subnet only can assoiate with one Network ACL by the time
ACL can assosiate with many subnets
ACL rules change will affect imediately



Exam tips

Your VPC automatically comes with a default network ACL, and by default it allows all outbound and inbound traffic
You can create custom network ACLs. By default, each custom network ACL denies all inbound and outbound traffic untill add rules
Each subnet in your VPC must associated with a network ACL. If you dont explicilty associate a subnet with a network ACL, the subnet automatically associated with the default network ACL
Block IP Addresses using ACLs not Security Groups
You can associate a network ACL with multiple subnets, however a subnet can be associate with only one network ACL at a time. When you associate a network ACL with a subnet, the previous
association is removed
Network ACLs contain anumberd list of rules that is evalueated in order, starting with the lowerst numberd rule
Network ACLs have seperate inbound and outbound rules, and each rule can either allow or deny traffic.
Network ACLs are stateless responses to allowed inbound traffic sre subject to the rules for outbound traffice(and vice versa)































	











 



